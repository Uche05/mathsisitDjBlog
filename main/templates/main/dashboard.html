{% extends 'base.html' %}
{% block title %}Dashboard · Maths Notes{% endblock %}

{% block content %}
<h1>Your dashboard</h1>
<p class="muted small">Manage your maths posts here.</p>

<div style="margin: 12px 0;">
  <a class="btn" href="{% url 'post_create' %}">Create new post</a>
</div>

<div class="posts">
  {#  Loop over the paginated page object instead of my_posts #}
  {% for post in page_obj %}
    <article class="post-card">
      <div style="display:flex;justify-content:space-between;gap:10px;align-items:center">
        <div>
          <h3 style="margin:0;font-size:16px">{{ post.title }}</h3>
          <div class="small muted">{{ post.created_at|date:"M j, Y H:i" }} · {{ post.status }}</div>
        </div>
        <div class="post-actions">
          <a class="btn ghost" href="{% url 'post_edit' post.slug %}">Edit</a>

          <a class="btn danger" href="{% url 'post_delete' post.slug %}">Delete</a>
        </div>
      </div>
    </article>
  {% empty %}
    <p class="muted small">You haven’t created any posts yet.</p>
  {% endfor %}
</div>

{#  Pagination controls (only show if there is more than 1 page) #}
{% if page_obj.paginator.num_pages > 1 %}
<ul class="pagination justify-content-center" style="margin-top:16px">
  {% if page_obj.has_previous %}
  <li>
    <a href="?page={{ page_obj.previous_page_number }}" class="page-link">
      &laquo; PREV
    </a>
  </li>
  {% endif %}

  <li class="page-item disabled">
    <span class="page-link">
      Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
    </span>
  </li>

  {% if page_obj.has_next %}
  <li>
    <a href="?page={{ page_obj.next_page_number }}" class="page-link">
      NEXT &raquo;
    </a>
  </li>
  {% endif %}
</ul>
{% endif %}
{% endblock %}
